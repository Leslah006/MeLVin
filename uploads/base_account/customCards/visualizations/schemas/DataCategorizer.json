{"title":"DataCategorizer","description":"DataCategorizer","className":"DataCategorizer","allowOutConn":true,"allowInConn":true,"outConnections":[{"type":"OPTION_CONNECTION","name":"Option","desc":"List of options","disabled":true,"index":0},{"type":"COLOR_CONNECTION","unique":true,"name":"Group","desc":"Group","index":0}],"inConnections":[{"type":"OPTION_CONNECTION","unique":true,"name":"Option","desc":"List of options","disabled":true,"index":0},{"type":"SELECTION_CONNECTION","unique":false,"name":"Data selections","desc":"","index":0}],"shareSelection":false,"shareData":true,"category":"viz","selectedLibs":[],"previewDataFile":"","selectedPreview":"color_group.svg","methods":{"init":{"code":"console.log(\"Data categorizer\");\nthis.color = \"#000\";\nthis.groups = input.groups || state.groups || [];\nvar self = this;\nself.repaintGroups(container, setProperty);\nvar addToGroupLB = \"<div class='lb_addToGroup' style='display: none;position: absolute; background-color: rgba(0, 0, 0, 0.4);justify-content:  center; align-items:  center; width:  100%; height: 100%;'>\" +\n  \"<div class='d-flex flex-column justify-content-center font-weight-bold text-left p-3' style='background-color:  #f5f5f5;min-height: 150px; width:  80%; border-radius: 3px; padding-top:0;'>\" +\n  \"<button class='btn btn-sm btn-empty btn_closeAddToGroup align-self-end pb-2'>\" +\n  \"<span class='fa fa-times'/>\" +\n  \"</button>\" +\n  \"<div class='pb-3'>\" +\n  \"  <label>Select group</label>\" +\n  \"  <select class='form-control groupSelection'>\" +\n  \"  </select>\" +\n  \"</div>\" +\n  \"<button class='btn btn-primary btn_addToGroupConfirm'>Add to group</button>\" +\n  \"</div>\" +\n  \"</div>\";\n\nvar createGroupLB = \"<div class='lb_createGroup' style='display: none;position: absolute; background-color: rgba(0, 0, 0, 0.4);justify-content:  center; align-items:  center; width:  100%; height: 100%;'>\" +\n  \"<div class='d-flex flex-column justify-content-center font-weight-bold text-left p-3' style='background-color:  #f5f5f5; min-height: 220px;width:  80%; border-radius: 3px;'>\" +\n  \"<button class='btn btn-sm btn-empty  btn_closeCreateGroup  align-self-end pb-2'>\" +\n  \"<span class='fa fa-times'/>\" +\n  \"</button>\" +\n  \"<div class='pb-3'>\" +\n  \"  <label>Group name</label>\" +\n  \"  <input type='text' class='form-control groupName' >\" +\n  \"</div>\" +\n  \"<div class='pb-3'>\" +\n  \"  <label>Color</label>\" +\n  \"  <input type='color' style='height: 38px'  class='form-control groupColor'/>\" +\n  \"</div>\" +\n  \"<button class='btn btn-primary btn_createGroupConfirm'>Create group</button>\" +\n  \"</div>\" +\n  \"</div>\";\n\n$(container).empty();\n$(container).css(\"overflow-x\", \"auto\");\n$(container).css(\"overflow-y\", \"auto\");\n$(container).css(\"display\", \"flex\");\n$(container).css(\"flex-flow\", \"column\");\n$(container).append(addToGroupLB + createGroupLB +\n  \"<div class='d-flex align-items-center w-100 p-3 justify-content-center' style='background-color: #fbfbfb;border-bottom: 1px solid #dddddd;'>\" +\n  \" <span class='datagrouper_numSelected font-weight-bold'>No items selected</span>\" +\n  \"</div>\" +\n  \"<div class='d-flex align-items-center justify-content-between w-100 pl-3 pr-3 pt-2 pb-2' style='background-color: #fbfbfb;border-bottom: 1px solid #dddddd;'>\" +\n  \" <h5 class='mb-0'>Selection</h5>\" +\n  \" <div>\" +\n  \"  <button class='btn btn-outline-primary btn-sm addToGroup_btn'><i class='fa fa-plus mr-1'/>Add to group</button>\" +\n  \"  <button class='btn btn-outline-primary btn-sm createGroup_btn ml-3'><i class='fa fa-edit mr-1'/>Add to new group</button>\" +\n  \" </div>\" +\n  \"</div> \" +\n  \"<div class='d-flex align-items-center justify-content-between w-100 pl-3 pr-3 pt-2 pb-2' style='background-color: #fbfbfb;border-bottom: 1px solid #dddddd;'>\" +\n  \" <h5 class='mb-0'>Groups</h5>\" +\n  \" <div>\" +\n  \" <button class='btn btn-outline-danger btn-sm removeGroups_btn'><i class='fa fa-trash mr-1'/>Remove all groups</button>\" +\n  \" </div>\" +\n  \"</div> \" +\n  \"<div class='groups groups flex-grow d-flex align-items-center w-100' style='background-color: #fff;border-bottom: 1px solid #dddddd;'>\" +\n  \"</div>\"\n);\n\n// \"<div class='tableContent' style='padding:15px;display:flex;flex-grow:1;'>\" +\n// \"</div>\");\n\n\n$(container).find('.removeGroups_btn').on('click', function() {\n  self.groups = [];\n  setProperty(\"groups\", self.groups);\n  self.repaintGroups(container, setProperty);\n});\n\n\n$(container).find('.addToGroup_btn').on('click', function() {\n  $(container).find('.groupSelection').empty().append(\n    self.groups.map(function(group) {\n      return \"<option>\" + group.name + \"</option>\";\n    }).join('')\n  );\n  $(container).find('.lb_addToGroup').css(\"display\", \"flex\");\n});\n\n$(container).find('.createGroup_btn').on('click', function() {\n  $(container).find('.lb_createGroup').css(\"display\", \"flex\");\n});\n\n$(container).find('.btn_closeAddToGroup').on('click', function() {\n  $(container).find('.lb_addToGroup').css(\"display\", \"none\");\n});\n\n$(container).find('.btn_closeCreateGroup').on('click', function() {\n  $(container).find('.lb_createGroup').css(\"display\", \"none\");\n});\n\n$(container).find('.groupColor').on('change', this.changeColor());\n\n\n$(container).find('.btn_createGroupConfirm').on('click', function() {\n  var name = $(container).find('.groupName').prop(\"value\");\n  var color = self.color;\n  self.groups.push({\n    name: name,\n    color: color,\n    points: Object.assign({}, self.selectedIDs)\n  });\n\n  $(container).find('.groups').text($(container).find('.groups').text() + \" \" + name);\n  $(container).find('.lb_createGroup').css(\"display\", \"none\");\n  self.repaintGroups(container, setProperty);\n  setProperty(\"groups\", self.groups)\n});\n\n$(container).find('.btn_addToGroupConfirm').on('click', function() {\n  var groupName = $(container).find('.groupSelection').prop(\"value\");\n  self.groups.forEach(function(group) {\n    if (group.name === groupName) {\n      group.points = Object.assign({}, group.points, self.selectedIDs);\n    }\n  });\n  $(container).find('.lb_addToGroup').css(\"display\", \"none\");\n  setProperty(\"groups\", self.groups)\n\n});\n\nd3.select($(container).find('.groups')[0]).selectAll(\"span\")\n  .data(this.groups).enter().append(\"span\").text(function(d) {\n    return d.name;\n  });\n\n\nthis.repaintGroups(container, setProperty);","args":"container, input, state, dataHandler, setProperty","isRemovable":false,"hasCustomArgs":false,"canBeRenamed":false},"update":{"code":"console.log(\"update\");\n\nvar selectedIDs = {};\ninput.selection.forEach(function(selection) {\n  Object.assign(selectedIDs, selection.points)\n});\n\nthis.selectedIDs = selectedIDs;\nvar numSelected = Object.keys(selectedIDs).length;\nthis.repaintGroups(container, setProperty);\nif (numSelected > 0) {\n  $(container).find(\".datagrouper_numSelected\").text(numSelected + \" items selected\");\n  /*  d3.select(container).selectAll('tr').style(\"background-color\", function (d) {\n        if (d && selectedIDs[d[0]]) {\n            return \"#a6c9e7\";\n        } else\n            return null;\n    })\n        .sort(function (first, second) {\n            return first && second ? selectedIDs[first[0]] && selectedIDs[second[0]] ? 0 : selectedIDs[first[0]] ? -1 : 1 : -1;\n        });\n        */\n} else {\n  $(container).find(\".datagrouper_numSelected\").text(\"No items selected\");\n}","args":"container, input, state, dataHandler, setProperty","isRemovable":false,"hasCustomArgs":false,"canBeRenamed":false},"repaintGroups":{"code":"$(container).find('.groups').empty().append(\n  this.groups.map(function(group) {\n    return \"<div style='padding: 6px 10px; background-color:  white; margin: 8px 8px 8px 16px; border: 1px solid #dddddd;float: left;'>\" +\n      \"<span class='fa fa-square' style='color:\" + group.color + \";'></span>\" +\n      \"<span style='font-size: 14px;font-weight:  bold;'> \" +\n      group.name +\n      \"</span>\" +\n      \"<span class='far fa-edit' style='color: #373737;margin-left: 26px;font-size: 12px;cursor:  pointer;'/>\" +\n      \"<span class='far fa-trash-alt removeGroup' data-group-name='\" + group.name + \"' style='color: #373737;padding-left: 6px;font-size: 12px;cursor:  pointer;'/>\" +\n      \"</div>\"\n  })\n);\nvar self = this;\n$(container).find('.removeGroup').on('click', function() {\n  var name = $(this).attr(\"data-group-name\");\n  var index = -1;\n  for (var i = 0; i < self.groups.length; i++)\n    if (self.groups[i].name === name)\n      index = i;\n\n  if (index > -1)\n    self.groups.splice(index, 1);\n\n  setProperty(\"groups\", self.groups);\n\n  self.repaintGroups(container, setProperty);\n});","args":"container, setProperty","isRemovable":true,"hasCustomArgs":true,"canBeRenamed":true},"changeColor":{"code":"var self = this;\nreturn function(event) {\n  self.color = event.target.value;\n};","args":[],"isRemovable":true,"hasCustomArgs":true,"canBeRenamed":true}},"options":[],"thumbnail":"./auth/previews/color_group.svg","preview":"color_group.svg","id":"DataCategorizer","loadPreview":true,"hasOptions":false}